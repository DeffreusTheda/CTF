# https://www.usb.org/sites/default/files/documents/hut1_12v2.pdf
usbmap = {
0x04: {0:'a', 2:'A'},
0x05: {0:'b', 2:'B'},
0x06: {0:'c', 2:'C'},
0x07: {0:'d', 2:'D'},
0x08: {0:'e', 2:'E'},
0x09: {0:'f', 2:'F'},
0x0A: {0:'g', 2:'G'},
0x0B: {0:'h', 2:'H'},
0x0C: {0:'i', 2:'I'},
0x0D: {0:'j', 2:'J'},
0x0E: {0:'k', 2:'K'},
0x0F: {0:'l', 2:'L'},
0x10: {0:'m', 2:'M'},
0x11: {0:'n', 2:'N'},
0x12: {0:'o', 2:'O'},
0x13: {0:'p', 2:'P'},
0x14: {0:'q', 2:'Q'},
0x15: {0:'r', 2:'R'},
0x16: {0:'s', 2:'S'},
0x17: {0:'t', 2:'T'},
0x18: {0:'u', 2:'U'},
0x19: {0:'v', 2:'V'},
0x1A: {0:'w', 2:'W'},
0x1B: {0:'x', 2:'X'},
0x1C: {0:'y', 2:'Y'},
0x1D: {0:'z', 2:'Z'},
0x1E: {0:'1', 2:'!'},
0x1F: {0:'2', 2:'@'},
0x20: {0:'3', 2:'#'},
0x21: {0:'4', 2:'$'},
0x22: {0:'5', 2:'%'},
0x23: {0:'6', 2:'^'},
0x24: {0:'7', 2:'&'},
0x25: {0:'8', 2:'*'},
0x26: {0:'9', 2:'('},
0x27: {0:'0', 2:')'},
0x28: {0:'\n',2:'\n'},
0x2B: {0:'\t',2:'\t'},
0x2C: {0:' ', 2:' '},
0x2D: {0:'-', 2:'_'},
0x2E: {0:'=', 2:'+'},
0x2F: {0:'[', 2:'{'},
0x30: {0:']', 2:'}'},
0x31: {0:"'", 2:'|'},
0x32: {0:'#', 2:'~'},
0x33: {0:';', 2:':'},
0x34: {0:'‘', 2:'“'},
0x35: {0:'`', 2:'~'},
0x36: {0:',', 2:'<'},
0x37: {0:'.', 2:'>'},
0x38: {0:'/', 2:'?'}
}

# tshark -r packet.pcapng -Y 'usb.src == "2.4.1"' -T fields -e usb.capdata >cap
file = open('cap', 'r')
alt = ''
for line in file:
    try:
        c = usbmap[int(line[2:4], 16)][int(line[:2])]
        alt += usbmap[int(line[2:4], 16)][0 if int(line[:2]) == 2 else 2]

        print(end=c)
    except KeyError:
        pass
print(f'\n{alt}')
