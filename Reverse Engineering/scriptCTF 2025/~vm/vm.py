#!/usr/bin/env python3
import sys
import struct

bin = bytes([
    0x60, 0x00, 0x01, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x03, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x15, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x79, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x02, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0B, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x13, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x90, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x0D, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0E, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x11, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0xDF, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x0E, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x10, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x12, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0xF9, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x04, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0E, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x11, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x1D, 0x01, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x02, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0C, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x0D, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x97, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x04, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x06, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x09, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x49, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x10, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x15, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x16, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0xE2, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x03, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0C, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x13, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x5F, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x08, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0B, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x13, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x70, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x02, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x03, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x06, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x27, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x04, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x07, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x08, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x77, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x02, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0F, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x14, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x9B, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x08, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x11, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x14, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x58, 0x01, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x01, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x02, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x08, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x75, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x09, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0C, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x14, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x14, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x04, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0F, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x15, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x1E, 0x01, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x06, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x08, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x11, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x8A, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x06, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0C, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x14, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0xE5, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x08, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0D, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x0F, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x3D, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x0B, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x11, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x15, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x08, 0x01, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x01, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x02, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x0E, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x1A, 0x01, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x03, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x04, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x16, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0xD3, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x00, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x06, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x0F, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x12, 0x01, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x07, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0C, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x16, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0xDE, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x01, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x04, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x0E, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0xD2, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x03, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x10, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x11, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x1A, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x0E, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0F, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x12, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0xB9, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x0A, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x11, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x13, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x5B, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x03, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x05, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x0C, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x5F, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x02, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x15, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x16, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x19, 0x01, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x04, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0F, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x11, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x9D, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x03, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0C, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x10, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x39, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x07, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0F, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x13, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x53, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x02, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x05, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x09, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x1C, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x02, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x14, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x16, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x78, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x03, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x06, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x08, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0xE7, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x06, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0B, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x12, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x56, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x03, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0F, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x11, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0xDA, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x00, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0B, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x12, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x07, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x09, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0C, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x11, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x10, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x08, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0C, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x0F, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x1C, 0x01, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x00, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x10, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x15, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0xC7, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x01, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x05, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x12, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x97, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x0A, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x14, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x15, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x33, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x0B, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0C, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x0E, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0xA7, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x02, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x09, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x0C, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x70, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x04, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x06, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x0A, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0xA4, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x05, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0B, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x0F, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x37, 0x01, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x04, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x09, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x0A, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x17, 0x01, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x07, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x08, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x0A, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x77, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x03, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0B, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x15, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0xC5, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x0B, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0F, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x14, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x54, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x00, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x05, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x08, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x1A, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x02, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x06, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x16, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x8A, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x09, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0F, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x14, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x38, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x04, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x12, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x15, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x12, 0x01, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x03, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0B, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x0E, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0xA1, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x07, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x09, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x10, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0xF7, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x05, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0B, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x10, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x5F, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x05, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x07, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x0E, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0xE1, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x08, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0E, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x0F, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x3C, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x07, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0A, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x0E, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x3C, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x03, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x04, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x08, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x15, 0x01, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x03, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x08, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x14, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x31, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x09, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0B, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x14, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0x04, 0x01, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x01, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x0B, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x01,                         # R1 ^= R2
    0x60, 0x02, 0x15, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x19, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x03, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x08, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x15, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x02,                         # R1 += R2
    0x10, 0x03, 0xD6, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x60, 0x00, 0x03, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x60, 0x01, 0x08, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x20, 0x00, 0x01,                         # R1 += R2
    0x60, 0x02, 0x09, 0x00, 0x00, 0x00,       # R1 = FLAG[IDX]
    0x30, 0x00, 0x02,                         # R1 ^= R2
    0x10, 0x03, 0x90, 0x00, 0x00, 0x00,       # R1 = IMM
    0x50, 0x00, 0x03, 0x28, 0x0A, 0x00, 0x00, # CMP JUMP
    
    0x10, 0x01, 0x69, 0x69, 0x69, 0x69,       # R1 = IMM
    0x70,
    0x40, 0x28, 0x0A, 0x00, 0x00,
    0x40, 0x28, 0x0A, 0x00, 0x00,
    0x40, 0x28, 0x0A, 0x00, 0x00,
    0x40, 0x28, 0x0A, 0x00, 0x00,
    0x40, 0x28, 0x0A, 0x00, 0x00,
    0x40, 0x28, 0x0A, 0x00, 0x00,
    0x40, 0x28, 0x0A, 0x00, 0x00,
    0x40, 0x28, 0x0A, 0x00, 0x00,
    0x10, 0x01, 0x00, 0x00, 0x00, 0x00,       # R1 = IMM
    0xFF, 
])

class VM:
    def __init__(self):
        self.registers = [0] * 8  # 8 x 32-bit registers
        self.code = bytearray()
        self.pc = 0
        self.cycles = 100000
        
        # Constant lookup table (placeholder - replace with actual values)
        self.constants = b"ABCDEFGHIJKLMNOPQRSTUV"  # 23 bytes
        
        # Opcodes
        self.OP_LOAD_IMM = 0x10
        self.OP_ADD_REG = 0x20
        self.OP_XOR_REG = 0x30
        self.OP_JMP_COND = 0x40
        self.OP_COMPARE = 0x50  # 'P'
        self.OP_LOAD_CONST = 0x60  # '`'
        self.OP_PRINT = 0x70  # 'p'
        
        self.debug = True

        self.pc_start = 0
    
    def debug_print(self, msg):
        if self.debug:
            print(f"[{hex(self.pc_start)[2:].rjust(3, ' ')}] {msg}")
    
    def print_state(self):
        return # the virtue of the one holding the knife
        if self.debug:
            reg_str = " ".join([f"R{i}={self.registers[i]:08x}" for i in range(8)])
            print(f"[STATE] PC={self.pc:04x} {reg_str} Cycles={self.cycles}")
    
    def load_code(self, code_bytes):
        """Load bytecode into VM"""
        if len(code_bytes) > 4096:
            print("y ur code so long bruh", file=sys.stderr)
            sys.exit(1)
        
        self.code = bytearray(code_bytes)
        self.debug_print(f"Loaded {len(self.code)} bytes of code")
    
    def decode_int32(self):
        """Decode 4-byte little-endian integer from current PC position"""
        if self.pc + 4 > len(self.code):
            print("oob access detected", file=sys.stderr)
            sys.exit(1)
        
        value = struct.unpack('<I', self.code[self.pc:self.pc+4])[0]
        self.pc += 4
        return value
    
    def bounds_check(self, addr):
        """Check if address is within code bounds"""
        if addr >= len(self.code):
            print("bounds violation", file=sys.stderr)
            sys.exit(1)
    
    def execute(self):
        """Execute VM bytecode"""
        self.debug_print("Starting execution")
        
        while self.pc < len(self.code) and self.cycles > 0:
            self.print_state()
            
            opcode = self.code[self.pc]
            # self.debug_print(f"Executing opcode {opcode:02x} at PC {self.pc:04x}") # the virtue of the one holding the knife
            self.pc_start = self.pc
            self.pc += 1
            
            if opcode == self.OP_LOAD_IMM:  # 0x10
                if self.pc >= len(self.code):
                    self.bounds_error()
                
                reg_id = self.code[self.pc] & 0x7
                self.pc += 1
                
                imm_value = self.decode_int32()
                self.registers[reg_id] = imm_value & 0xFFFFFFFF
                
                self.debug_print(f"LOAD_IMM: R{reg_id} = 0x{imm_value:08x}")
            
            elif opcode == self.OP_ADD_REG:  # 0x20
                if self.pc + 1 >= len(self.code):
                    self.bounds_error()
                
                dst_reg = self.code[self.pc] & 0x7
                src_reg = self.code[self.pc + 1] & 0x7
                self.pc += 2
                
                old_val = self.registers[dst_reg]
                self.registers[dst_reg] = (self.registers[dst_reg] + self.registers[src_reg]) & 0xFFFFFFFF
                
                self.debug_print(f"ADD_REG: R{dst_reg} (0x{old_val:08x}) += R{src_reg} (0x{self.registers[src_reg]:08x}) = 0x{self.registers[dst_reg]:08x}")
            
            elif opcode == self.OP_XOR_REG:  # 0x30
                if self.pc + 1 >= len(self.code):
                    self.bounds_error()
                
                dst_reg = self.code[self.pc] & 0x7
                src_reg = self.code[self.pc + 1] & 0x7
                self.pc += 2
                
                old_val = self.registers[dst_reg]
                self.registers[dst_reg] = (self.registers[dst_reg] ^ self.registers[src_reg]) & 0xFFFFFFFF
                
                self.debug_print(f"XOR_REG: R{dst_reg} (0x{old_val:08x}) ^= R{src_reg} (0x{self.registers[src_reg]:08x}) = 0x{self.registers[dst_reg]:08x}")
            
            elif opcode == self.OP_JMP_COND:  # 0x40 (@)
                jump_target = self.decode_int32()
                
                if jump_target >= len(self.code):
                    print("y u trying to jmp to those places", file=sys.stderr)
                    sys.exit(1)
                
                self.debug_print(f"JMP_COND: jumping to 0x{jump_target:04x}")
                self.pc = jump_target
            
            elif opcode == self.OP_COMPARE:  # 0x50 (P)
                if self.pc + 1 >= len(self.code):
                    self.bounds_error()
                
                reg1 = self.code[self.pc] & 0x7
                reg2 = self.code[self.pc + 1] & 0x7
                self.pc += 2
                
                jump_target = self.decode_int32()
                
                val1 = self.registers[reg1]
                val2 = self.registers[reg2]
                
                if val1 != val2:
                    if jump_target >= len(self.code):
                        print("y r u trying to pwn this vm :(", file=sys.stderr)
                        sys.exit(1)
                    
                    self.debug_print(f"COMPARE: R{reg1} (0x{val1:08x}) != R{reg2} (0x{val2:08x}), jumping to 0x{jump_target:04x}")
                    self.pc = jump_target
                else:
                    self.debug_print(f"COMPARE: R{reg1} (0x{val1:08x}) == R{reg2} (0x{val2:08x}), no jump")
            
            elif opcode == self.OP_LOAD_CONST:  # 0x60 (`)
                if self.pc >= len(self.code):
                    self.bounds_error()
                
                reg_id = self.code[self.pc] & 0x7
                self.pc += 1
                
                const_idx = self.decode_int32()
                
                if const_idx > 22:
                    print("i told u no pwning", file=sys.stderr)
                    sys.exit(1)
                
                const_val = self.constants[const_idx]
                self.registers[reg_id] = const_val
                
                self.debug_print(f"LOAD_CONST: R{reg_id} = constants[{const_idx}] = 0x{const_val:02x}")
            
            elif opcode == self.OP_PRINT:  # 0x70 (p)
                self.debug_print("PRINT: halting execution")
                break
            
            else:
                print("wtf is this op bruh :skull:", file=sys.stderr)
                return 1
            
            self.cycles -= 1
            
            if self.pc > len(self.code):
                self.bounds_error()
        
        if self.cycles == 0:
            print("y u take this long", file=sys.stderr)
            sys.exit(1)
        
        self.check_result()
        return 0
    
    def bounds_error(self):
        print("bounds error", file=sys.stderr)
        sys.exit(1)
    
    def check_result(self):
        """Check win condition"""
        magic_value = 0x69696969
        self.debug_print(f"Checking R1: 0x{self.registers[1]:08x} vs magic 0x{magic_value:08x}")
        
        if self.registers[1] == magic_value:
            print("_______________________")
        else:
            print("lol, nice try")

def main():
    if len(sys.argv) > 1 and sys.argv[1] == "--no-debug":
        debug_mode = False
    else:
        debug_mode = True
    
    vm = VM()
    vm.debug = debug_mode
    
    # Read bytecode from stdin
    try:
        code = sys.stdin.buffer.read()
        vm.load_code(code)
        return vm.execute()
    except KeyboardInterrupt:
        print("\nInterrupted", file=sys.stderr)
        return 1
    except Exception as e:
        print(f"Error: {e}", file=sys.stderr)
        return 1

if __name__ == "__main__":
    sys.exit(main())
