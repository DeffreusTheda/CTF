/* This file was generated by the Hex-Rays decompiler version 8.4.0.240320.
   Copyright (c) 2007-2021 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 (**init_proc())(void);
__int64 sub_401020();
__int64 sub_401030(); // weak
__int64 sub_401040(); // weak
__int64 sub_401050(); // weak
__int64 sub_401060(); // weak
__int64 sub_401070(); // weak
__int64 sub_401080(); // weak
// int putchar(int c);
// int puts(const char *s);
// int printf(const char *format, ...);
// __int64 __isoc99_scanf(const char *, ...); weak
// int sprintf(char *s, const char *format, ...);
void __fastcall __noreturn start(__int64 a1, __int64 a2, void (*a3)(void));
char *sub_401130();
char *sub_4011A0();
__int64 sub_4011D0(); // weak
_BOOL8 __fastcall check6Cardinals(unsigned int a1, unsigned int a2, unsigned int a3, unsigned int a4, unsigned int a5, unsigned int a6);
__int64 __fastcall crazyMeth(unsigned int a1, unsigned int a2);
__int64 __fastcall crazyMethButNegateArg2(unsigned int a1, int a2);
__int64 __fastcall tillArg1Is0DoMath(unsigned int a1, int a2);
__int64 __fastcall whileArg1OrArg2DoXor(unsigned int a1, unsigned int a2);
__int64 __fastcall whileArg1OrArg2DoAnd(unsigned int a1, unsigned int a2);
void term_proc();
// int __fastcall _libc_start_main(int (__fastcall *main)(int, char **, char **), int argc, char **ubp_av, void (*init)(void), void (*fini)(void), void (*rtld_fini)(void), void *stack_end);
// __int64 _gmon_start__(void); weak

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN main;
__int64 (*qword_404010)(void) = NULL; // weak
char byte_404058; // weak


//----- (0000000000401000) ----------------------------------------------------
__int64 (**init_proc())(void)
{
  __int64 (**result)(void); // rax

  result = &_gmon_start__;
  if ( &_gmon_start__ )
    return (__int64 (**)(void))_gmon_start__();
  return result;
}
// 404098: using guessed type __int64 _gmon_start__(void);

//----- (0000000000401020) ----------------------------------------------------
__int64 sub_401020()
{
  return qword_404010();
}
// 404010: using guessed type __int64 (*qword_404010)(void);

//----- (0000000000401030) ----------------------------------------------------
__int64 sub_401030()
{
  return sub_401020();
}
// 401030: using guessed type __int64 sub_401030();

//----- (0000000000401040) ----------------------------------------------------
__int64 sub_401040()
{
  return sub_401020();
}
// 401040: using guessed type __int64 sub_401040();

//----- (0000000000401050) ----------------------------------------------------
__int64 sub_401050()
{
  return sub_401020();
}
// 401050: using guessed type __int64 sub_401050();

//----- (0000000000401060) ----------------------------------------------------
__int64 sub_401060()
{
  return sub_401020();
}
// 401060: using guessed type __int64 sub_401060();

//----- (0000000000401070) ----------------------------------------------------
__int64 sub_401070()
{
  return sub_401020();
}
// 401070: using guessed type __int64 sub_401070();

//----- (0000000000401080) ----------------------------------------------------
__int64 sub_401080()
{
  return sub_401020();
}
// 401080: using guessed type __int64 sub_401080();

//----- (00000000004010F0) ----------------------------------------------------
// positive sp value has been detected, the output may be wrong!
void __fastcall __noreturn start(__int64 a1, __int64 a2, void (*a3)(void))
{
  __int64 v3; // rax
  int v4; // esi
  __int64 v5; // [rsp-8h] [rbp-8h] BYREF
  char *retaddr; // [rsp+0h] [rbp+0h] BYREF

  v4 = v5;
  v5 = v3;
  _libc_start_main((int (__fastcall *)(int, char **, char **))main, v4, &retaddr, 0LL, 0LL, a3, &v5);
  __halt();
}
// 4010FA: positive sp value 8 has been found
// 401101: variable 'v3' is possibly undefined

//----- (0000000000401130) ----------------------------------------------------
char *sub_401130()
{
  return &byte_404058;
}
// 404058: using guessed type char byte_404058;

//----- (00000000004011A0) ----------------------------------------------------
char *sub_4011A0()
{
  char *result; // rax

  if ( !byte_404058 )
  {
    result = sub_401130();
    byte_404058 = 1;
  }
  return result;
}
// 404058: using guessed type char byte_404058;

//----- (00000000004011D0) ----------------------------------------------------
__int64 sub_4011D0()
{
  return 0LL;
}
// 4011D0: using guessed type __int64 sub_4011D0();

//----- (00000000004011D6) ----------------------------------------------------
__int64 __fastcall main(int a1, char **a2, char **a3)
{
  unsigned int v4; // [rsp+18h] [rbp-58h] BYREF
  unsigned int v5; // [rsp+1Ch] [rbp-54h] BYREF
  unsigned int v6; // [rsp+20h] [rbp-50h] BYREF
  unsigned int v7; // [rsp+24h] [rbp-4Ch] BYREF
  unsigned int v8; // [rsp+28h] [rbp-48h] BYREF
  unsigned int v9; // [rsp+2Ch] [rbp-44h] BYREF
  char s[56]; // [rsp+30h] [rbp-40h] BYREF
  unsigned __int64 v11; // [rsp+68h] [rbp-8h]

  v11 = __readfsqword(0x28u);
  puts("To get the flag, you must correctly enter six 9-digit positive integers: a, b, c, d, e, and f.");
  putchar(10);
  printf("a = ");
  __isoc99_scanf("%d", &v4);
  printf("b = ");
  __isoc99_scanf("%d", &v5);
  printf("c = ");
  __isoc99_scanf("%d", &v6);
  printf("d = ");
  __isoc99_scanf("%d", &v7);
  printf("e = ");
  __isoc99_scanf("%d", &v8);
  printf("f = ");
  __isoc99_scanf("%d", &v9);
  if ( check6Cardinals(v4, v5, v6, v7, v8, v9) )
  {
    puts("Correct.");
    sprintf(s, "uiuctf{%x%x%x%x%x%x}", v4, v5, v6, v7, v8, v9);
    puts(s);
  }
  else
  {
    puts("Wrong.");
  }
  return 0LL;
}
// 4010D0: using guessed type __int64 __isoc99_scanf(const char *, ...);

//----- (000000000040137B) ----------------------------------------------------
_BOOL8 __fastcall check6Cardinals(
        unsigned int a1,
        unsigned int a2,
        unsigned int a3,
        unsigned int a4,
        unsigned int a5,
        unsigned int a6)
{
  unsigned int tmp1; // eax
  int tmp2; // ebx
  unsigned int tmp3; // eax
  unsigned int tmp4; // ebx
  unsigned int tmp5; // eax
  unsigned int tmp6; // eax
  unsigned int res1; // [rsp+20h] [rbp-30h]
  unsigned int res2; // [rsp+24h] [rbp-2Ch]
  unsigned int res3; // [rsp+28h] [rbp-28h]
  unsigned int res4; // [rsp+2Ch] [rbp-24h]
  unsigned int res5; // [rsp+30h] [rbp-20h]
  unsigned int res6; // [rsp+34h] [rbp-1Ch]
  unsigned int res7; // [rsp+38h] [rbp-18h]
  unsigned int res8; // [rsp+3Ch] [rbp-14h]

  if ( a1 <= 0x5F5E100 || a2 <= 0x5F5E100 || a3 <= 0x5F5E100 || a4 <= 0x5F5E100 || a5 <= 0x5F5E100 || a6 <= 0x5F5E100 )
    return 0LL;
  if ( a1 > 0x3B9AC9FF || a2 > 0x3B9AC9FF || a3 > 0x3B9AC9FF || a4 > 0x3B9AC9FF || a5 > 0x3B9AC9FF || a6 > 0x3B9AC9FF )
    return 0LL;
  tmp1 = crazyMethButNegateArg2(a1, a2);
  res1 = (unsigned int)crazyMeth(tmp1, a3) % 0x10AE961;
  res2 = (unsigned int)crazyMeth(a1, a2) % 0x1093A1D;
  tmp2 = tillArg1Is0DoMath(2u, a2);
  tmp3 = tillArg1Is0DoMath(3u, a1);
  tmp4 = crazyMethButNegateArg2(tmp3, tmp2);
  res3 = tmp4 % (unsigned int)whileArg1OrArg2DoXor(a1, a4);
  tmp5 = crazyMeth(a3, a1);
  res4 = (unsigned int)whileArg1OrArg2DoAnd(a2, tmp5) % 0x6E22;
  res5 = (unsigned int)crazyMeth(a2, a4) % a1;
  tmp6 = crazyMeth(a4, a6);
  res6 = (unsigned int)whileArg1OrArg2DoXor(a3, tmp6) % 0x1CE628;
  res7 = (unsigned int)crazyMethButNegateArg2(a5, a6) % 0x1172502;
  res8 = (unsigned int)crazyMeth(a5, a6) % 0x2E16F83;
  return res1 == 4139449
      && res2 == 9166034
      && res3 == 556569677
      && res4 == 12734
      && res5 == 540591164
      && res6 == 1279714
      && res7 == 17026895
      && res8 == 23769303;
}

//----- (000000000040163D) ----------------------------------------------------
__int64 __fastcall crazyMeth(unsigned int a1, unsigned int a2)
{
  unsigned int v5; // [rsp+10h] [rbp-18h]
  char v6; // [rsp+14h] [rbp-14h]
  int v7; // [rsp+18h] [rbp-10h]
  int v8; // [rsp+1Ch] [rbp-Ch]
  __int64 v9; // [rsp+20h] [rbp-8h]

  v9 = 0LL;
  v5 = 0;
  v6 = 0;
  while ( a1 || a2 )
  {
    v7 = a1 & 1;
    v8 = a2 & 1;
    a1 >>= 1;
    a2 >>= 1;
    v9 += (v5 ^ v8 ^ v7) << v6;
    v5 = v5 & v7 | v8 & v7 | v5 & v8;
    ++v6;
  }
  return ((unsigned __int64)v5 << v6) + v9;
}

//----- (00000000004016D8) ----------------------------------------------------
__int64 __fastcall crazyMethButNegateArg2(unsigned int a1, int a2)
{
  return crazyMeth(a1, -a2);
}

//----- (00000000004016FE) ----------------------------------------------------
__int64 __fastcall tillArg1Is0DoMath(unsigned int a1, int a2)
{
  unsigned int v4; // [rsp+Ch] [rbp-Ch]
  int v5; // [rsp+10h] [rbp-8h]

  v4 = 0;
  v5 = 0;
  while ( a1 )
  {
    v4 += (a1 & 1) * (a2 << v5);
    a1 >>= 1;
    ++v5;
  }
  return v4;
}

//----- (000000000040174A) ----------------------------------------------------
__int64 __fastcall whileArg1OrArg2DoXor(unsigned int a1, unsigned int a2)
{
  unsigned int v5; // [rsp+8h] [rbp-10h]
  int v6; // [rsp+Ch] [rbp-Ch]
  int v7; // [rsp+10h] [rbp-8h]
  int v8; // [rsp+14h] [rbp-4h]

  v5 = 0;
  v6 = 0;
  while ( a1 || a2 )
  {
    v7 = a1 & 1;
    v8 = a2 & 1;
    a1 >>= 1;
    a2 >>= 1;
    v5 += (v8 ^ v7) << v6++;
  }
  return v5;
}

//----- (00000000004017A9) ----------------------------------------------------
__int64 __fastcall whileArg1OrArg2DoAnd(unsigned int a1, unsigned int a2)
{
  unsigned int v5; // [rsp+8h] [rbp-10h]
  int v6; // [rsp+Ch] [rbp-Ch]
  int v7; // [rsp+10h] [rbp-8h]
  int v8; // [rsp+14h] [rbp-4h]

  v5 = 0;
  v6 = 0;
  while ( a1 || a2 )
  {
    v7 = a1 & 1;
    v8 = a2 & 1;
    a1 >>= 1;
    a2 >>= 1;
    v5 += (v8 & v7) << v6++;
  }
  return v5;
}

//----- (0000000000401808) ----------------------------------------------------
void term_proc()
{
  ;
}

// nfuncs=34 queued=20 decompiled=20 lumina nreq=0 worse=0 better=0
// ALL OK, 20 function(s) have been successfully decompiled

