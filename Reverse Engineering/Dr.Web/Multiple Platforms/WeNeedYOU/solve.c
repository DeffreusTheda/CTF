#include <stdio.h>
#include <time.h>
#include <stdlib.h>

char question(int q_idx) {
  int unaff_r2;
  unsigned int seed;
  int random;
  int answer;
  unsigned int random2;
  int answer_key;

  seed = time((time_t *)0x0);
  srand(seed);
  random = rand();
  random2 = random % 3;
  answer = 0;
  answer_key = seed + (((int)seed >> 2) + (unsigned int)((int)seed < 0 && (seed & 3) != 0)) * -4 + 1;
  printf("Question: %s\n",(&PTR_s_questions)[q_idx]);
  __isoc23_scanf(&%d,&answer);
  if ((4 < answer) || (answer < 1)) {
    puts("bad format");
                    /* WARNING: Subroutine does not return */
    exit(0);
  }
  putchar(10);
  if (answer_key != answer) {
    puts("wrong");
                    /* WARNING: Subroutine does not return */
    exit(0);
  }
                    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
  }
}

int main() {
  int answer_key[] = {4, 2, 2, 1, 3, 3, 2, 1, 4, 1, 3, 4};
  char chars[] = {0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69, 0x6a, 0x6b, 0x6c, 0x6d, 0x6e, 0x6f, 0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 0x77, 0x78, 0x79, 0x7a, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x30, 0x45, 0x58, 0x50, 0x41, 0x4e, 0x44, 0x33, 0x36, 0x42, 0x4b, 0x45, 0x59};
  char key[] =  {0x2d, 0x70, 0xce, 0x09, 0xfa, 0x44, 0x91, 0xb2, 0x83, 0xf7, 0x37, 0x7b, 0xa5, 0x72, 0x60, 0x39, 0xc7, 0x5c, 0x68, 0xdd, 0x2e, 0xfe, 0xdc, 0x97, 0x77, 0xb8, 0x53, 0x79, 0x49, 0x61, 0x3c, 0x9f, 0x00, 0x87, 0x2f, 0x18, 0x30, 0x3d, 0xfe, 0xc4, 0xbb, 0x81, 0x09, 0x22, 0x13, 0x7b, 0x73, 0x13, 0x19, 0x47, 0xd6, 0x78, 0x99, 0x96, 0x93, 0x78, 0xcc, 0xdb, 0x78, 0x23, 0xff, 0xd0, 0xf8, 0x77, 0x01, 0x01, 0x01};
  char byte[64];
  int q_idx;
  unsigned int idx2;
  char* addr_flag;
  int stack_chk;

  addr_flag = 0;
  for (q_idx = 0; q_idx < 0xc; q_idx = q_idx + 1) {
    *(char *)(&addr_flag + q_idx) = question(q_idx);
  }
  init_RC4((int)&addr_flag,0xc);
  call_encrypt((int)key,(int)byte,0x40);
  unsigned int idx2 = 0;
  while( 1 ) {
    if (0x3f < idx2) break;
    printf("%02X",(unsigned int)byte[idx2]);
    idx2 = idx2 + 1;
  }
  putchar(10);
}
