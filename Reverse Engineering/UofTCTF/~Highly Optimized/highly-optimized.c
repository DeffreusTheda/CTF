/* This file was generated by the Hex-Rays decompiler version 8.4.0.240320.
   Copyright (c) 2007-2021 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>
#include <stdio.h>
#include <string.h>

//-------------------------------------------------------------------------
// Function declarations

#define OC_PUSH 0LL
#define OC_DUP 1LL
#define OC_SUBTRACT 2LL
#define OC_LESS_THAN 3LL
#define OC_JUMP_IF_TRUE 4LL
#define OC_PRINT 5LL
#define OC_EXIT 6LL

_QWORD ram[265] = {
  OC_PUSH, 58541471996096977LL,
  OC_PUSH, 131LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 131LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 42044768350026761LL,
  OC_PUSH, 130LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 130LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 104093991169115492LL,
  OC_PUSH, 146LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 146LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 128563766204312876LL,
  OC_PUSH, 120LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 120LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 118183210859642192LL,
  OC_PUSH, 121LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 121LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 31759579751918036LL,
  OC_PUSH, 160LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 160LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 37922191436980238LL,
  OC_PUSH, 143LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 143LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 139168641091494270LL,
  OC_PUSH, 147LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 147LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 152909243010516658LL,
  OC_PUSH, 138LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 138LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 88946238250907572LL,
  OC_PUSH, 163LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 163LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 179824179782506694LL,
  OC_PUSH, 170LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 170LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 45174131531571636LL,
  OC_PUSH, 52LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 52LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 58562759984008198LL,
  OC_PUSH, 65LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 65LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 60481677685756789LL,
  OC_PUSH, 120LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 120LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 67459793699055203LL,
  OC_PUSH, 141LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 141LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 33046999828954552LL,
  OC_PUSH, 137LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 137LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 67963425659164234LL,
  OC_PUSH, 135LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 135LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 43796972412552174LL,
  OC_PUSH, 117LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 117LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 6408227318773632LL,
  OC_PUSH, 68LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 68LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 75570635003173892LL,
  OC_PUSH, 68LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 68LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 26842364308653847LL,
  OC_PUSH, 122LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 122LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_PUSH, 60541299067063520LL,
  OC_PUSH, 147LL,
  OC_SUBTRACT,
  OC_DUP,
  OC_PUSH, 147LL,
  OC_LESS_THAN,
  OC_JUMP_IF_TRUE, 9LL,
  OC_PRINT,
  OC_EXIT
}; // weak
char byte_4868; // weak

//----- (00000000000010B0) ----------------------------------------------------
int main(int a1, char **a2, char **a3) {
  int stack_idx; // ebx
  int ip; // edx
  int v5; // r13d
  __int64 v6; // rdx
  __int64 v7; // rax
  __int64 v8; // rax
  __int64 stack[137]; // [rsp+0h] [rbp-448h] BYREF

  stack_idx = 0;
  puts("I will tell you the flag, if you don't mind waiting a few moments...");
  memset(stack, 0, 0x410uLL);
  ip = 0;
  while ( 1 ) {
    v5 = ip + 1;
    switch ( ram[ip] ) {
      case 0LL: // PUSH
        ip += 2;
        stack[stack_idx++ + 1] = ram[v5];
        break;
      case 1LL: // DUPLICATE TOP
        v6 = stack[stack_idx];
        v7 = stack_idx++;
        stack[v7 + 1] = stack[stack_idx];
        ip = v5;
        break;
      case 2LL: // SUBSTRACT
        stack[stack_idx - 1] -= stack[stack_idx];
        --stack_idx;
        ++ip;
        break;
      case 3LL: // LESS THAN
        stack[stack_idx - 1] = stack[stack_idx] < (unsigned __int64)stack[stack_idx - 1];
        --stack_idx;
        ++ip;
        break;
      case 4LL: // JUMP IF TRUE
        --stack_idx;
        ip += 2;
        if ( stack[stack_idx + 1] )
          ip -= LODWORD(ram[v5]);
        break;
      case 5LL: // PRINT
        putchar(SLOBYTE(stack[stack_idx--]));
        ip = v5;
        break;
      case 6LL: // EXIT
        return 0LL;
      default:
        ++ip;
        break;
    }
  }
}
// 4020: using guessed type _QWORD ram[265];

// nfuncs=22 queued=12 decompiled=12 lumina nreq=0 worse=0 better=0
// ALL OK, 12 function(s) have been successfully decompiled
