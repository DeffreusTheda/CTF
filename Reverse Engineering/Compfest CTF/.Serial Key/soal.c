/* This file was generated by the Hex-Rays decompiler version 8.4.0.240320.
   Copyright (c) 2007-2021 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

long long check(long long a1);
int main(int argc, const char **argv, const char **envp);

//-------------------------------------------------------------------------
// Data declarations

FILE *stdout; // idb
_UNKNOWN serial; // weak
int idx; // weak

long long check(long long a1) {
  char *s1[6];
  char s2[4];

  if ( strlen((const char *)a1) != 24 )
    return 0LL;
  for ( int i = 4; i <= 23; i += 5 )
    if ( *(_BYTE *)(i + a1) != 45 )
      return 0LL;
  if ( *(_BYTE *)(a1 + 10) != 67 )
    return 0LL;
  if ( *(_BYTE *)(a1 + 11) != 70 )
    return 0LL;
  if ( *(_BYTE *)(a1 + 12) != 49 )
    return 0LL;
  if ( *(_BYTE *)(a1 + 13) != 54 )
    return 0LL;
  for ( int i = 0; i < idx; ++i ) {
    if ( !strncmp(*((const char **)&serial + i), (const char *)a1, 0x18uLL) )
      return 0LL;
  }
  for ( int i = 0; i <= 23; i += 5 ) { // 0 5 10 15 20
    for ( int j = i; j <= i + 3; ++j ) {
      int v9 = *(char *)(j + a1);
      if ( (v9 <= 47 || v9 > 57) && (v9 <= 64 || v9 > 90) )
        return 0LL;
    }
    s2[0] = *(_BYTE *)(i + a1);
    s2[1] = *(_BYTE *)(i + 1LL + a1);
    s2[2] = *(_BYTE *)(i + 2LL + a1);
    s2[3] = *(_BYTE *)(i + 3LL + a1);
    for ( int j = 0; j < i / 5; ++j )
      if ( !strncmp(s1[j], s2, 4uLL) )
        return 0LL;
    s1[i / 5] = (char *)malloc(4uLL);
    s1[i / 5] = strdup(s2);
  }
  *((_QWORD *)&serial + idx) = malloc(0x18uLL);
  *((_QWORD *)&serial + idx) = strdup((const char *)a1);
  ++idx;
  return 1LL;
}

int main(int argc, const char **argv, const char **envp) {
  char v6[32];
  char v7[104];

  setvbuf(stdout, 0LL, 2, 0LL);
  for ( int i = 0; i <= 99; ++i ) {
    printf("Serial %d ==> ", (unsigned int)(i + 1));
    __isoc99_scanf("%s", v6);
    if ( !(unsigned int)check((long long)v6) ) {
      puts("Salah");
      return 0;
    }
  }
  FILE *v5 = fopen("flag.txt", "r");
  __isoc99_fscanf(v5, "%s", v7);
  printf("%s", v7);
  return 0;
}
