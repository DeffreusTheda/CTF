from z3 import sat, Solver, BitVec

targetString = b"asdghkashdfclkamsdfjalxsdkjfxhcaksvjnalsckuqpoiewt"
# generatedKey = ""

keyValues = [0x35, 0x0, 0x0, 0x0, 0x40, 0x0, 0x0, 0x0, 0x2, 0x0, 0x0, 0x0, 0x4, 0x0, 0x0, 0x0, 0x16, 0x0, 0x0, 0x0, 0x5A, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x47, 0x0, 0x0, 0x0, 0x13, 0x0, 0x0, 0x0, 0x18, 0x0, 0x0, 0x0, 0x52, 0x0, 0x0, 0x0, 0x1D, 0x0, 0x0, 0x0, 0x4, 0x0, 0x0]
keyValues = keyValues[:50]

# for i in range(0, 0x15D + 1, 7):
    # j = i
    # while j >= len(targetString):
        # j -= len(targetString)
    # generatedKey += targetString[j]
# print(f'{generatedKey=}')
generatedKey=b'asalxjutakafvkwkljjscehcfkksigfddaloddsscapshmxhnq'
a = [0x35, 0x0, 0x0, 0x0, 0x40, 0x0, 0x0, 0x0, 0x2, 0x0, 0x0, 0x0, 0x4, 0x0, 0x0, 0x0, 0x16, 0x0, 0x0, 0x0, 0x5A, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x47, 0x0, 0x0, 0x0, 0x13, 0x0, 0x0, 0x0, 0x18, 0x0, 0x0, 0x0, 0x52, 0x0, 0x0, 0x0, 0x1D, 0x0, 0x0, 0x0, 0x4, 0x0, 0x0, 0x0, 0x0E, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0E, 0x0, 0x0, 0x0, 0x1E, 0x0, 0x0, 0x0, 0x19, 0x0, 0x0, 0x0, 0x0F, 0x0, 0x0, 0x0, 0x2C, 0x0, 0x0, 0x0, 0x6, 0x0, 0x0, 0x0, 0x0B, 0x0, 0x0, 0x0, 0x0F, 0x0, 0x0, 0x0, 0x52, 0x0, 0x0, 0x0, 0x8, 0x0, 0x0, 0x0, 0x0E, 0x0, 0x0, 0x0, 0x0E, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3B, 0x0, 0x0, 0x0, 0x5, 0x0, 0x0, 0x0, 0x3E, 0x0, 0x0, 0x0, 0x0F, 0x0, 0x0, 0x0, 0x7, 0x0, 0x0, 0x0, 0x5, 0x0, 0x0, 0x0, 0x8, 0x0, 0x0, 0x0, 0x1F, 0x0, 0x0, 0x0, 0x16, 0x0, 0x0, 0x0, 0x0D, 0x0, 0x0, 0x0, 0x6, 0x0, 0x0, 0x0, 0x15, 0x0, 0x0, 0x0, 0x2C, 0x0, 0x0, 0x0, 0x6, 0x0, 0x0, 0x0, 0x2, 0x0, 0x0, 0x0, 0x47, 0x0, 0x0, 0x0, 0x57, 0x0, 0x0, 0x0, 0x51, 0x0, 0x0, 0x0, 0x0C, 0x0, 0x0, 0x0]
key = a[::4]
for i, g in enumerate(generatedKey):
    print(end=f'{chr(key[i] ^ g)}')
print()


# inp = input('password: ')
# inp = [BitVec(f'b{i}', 8) for i in range(50)]
# s = Solver()

# for k in range(len(generatedKey)):
    # proc += keyValues[k] ^ inp[k]
    # s.add(keyValues[k] ^ inp[k] == generatedKey[k])

# len is 50
# if len(inp) <= 50:
    # if len(inp) > 49:
        # proc = ""
        # for k in range(len(generatedKey)):
            # proc += keyValues[k] ^ inp[k]
            # s.add(keyValues[k] ^ inp[k] == generatedKey[k])
        
        # if proc == generatedKey:
            # print('succ')
        # else:
            # print('im bad')
        # exit(0)
    # else:
        # print('short.')
        # exit(0)
# else:
    # print('longg :3')
    # exit(0)
    
# if s.check() == sat:
#     model = s.model()
#     for i, ss in enumerate(model):
#         print(chr(model[inp[i]].as_long()), end='')
#     print()
# else:
#     print("z3 fail!")