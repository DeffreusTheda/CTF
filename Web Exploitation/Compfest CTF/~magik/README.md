# magik Writeup by Deffreus - CompfestCTF 16

######  Author: mone

## Description

i can do magik you know ^^

`http://challenges.ctf.compfest.id:20002`

[magik.php](https://ctf.compfest.id/files/58e510b918c269b40373c771efe2987b/magik.php?token=eyJ1c2VyX2lkIjo3MiwidGVhbV9pZCI6MzA3LCJmaWxlX2lkIjozNX0.Zq-ghA.VmShSI6G07fOX5ns4DsIN2AxWUo)

## Solution

We have to supply the `secret` parameter on our link to pass this:

```magik.php
if (isset($_GET['secret'])) {␍
  if ($_GET['secret'] !== "240610708" && md5($_GET['secret']) == "0e462097431906509019562988736854" && $_GET['secret'] !== "3069655" && md5($_GET['secret']) == "0e731198106197620485820904131008") {␍
    echo "REDACTED";␍
  } else {␍
    echo "Invalid secret!";␍
  }␍
} else {␍
  echo "Please specify secret in the GET parameter!";␍
}␍
wares```

The vulnerability is here:<br>
In PHP, any value that starts with `0e` will be treated as if it's a scientific number.
Well, `0eX` would equate to `0`, no matter what `X` is!
These MD5 hashes are treated that way too, so they're basically `0` in the eye of PHP.

Other than that, we just need our password to not be `240610708` or `3069655`.
These two string would produce a MD5 hashed that starts with `0e`,
but it's excluded,
so we need to find another suitable string,
and one of them is:

`QNKCDZO`

If we use that as the value to `secret` parameter,
we'll pass the check and the webpage will gives us the flag!

Flag: `COMPFEST16{1_h4T3_pHp_lmA000000_8da795d09f}`
