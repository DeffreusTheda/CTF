from Crypto.Util.number import long_to_bytes, GCD, inverse
import gmpy2

# Given values
pq = 8936396806210526376141535339320387823150632232768025074585150591450030342206739518984596873580048532158059431947151704989934421112343371270553045654957003707832178597263987770629732733312586314686634975339561970271092488597023151433664491322133177095608320300299786978779169268542548863459526287208102109014561040941363941559454093027421535766246401867857307704897740625661125317008732659703903812825923671450283119589909627550816583337750263847443638256518882885826501709869226134948243652941257691269039832456963313242820268668152500562964805729573667818693090015710068568308108426351178618148559207653302567726453
a = 32061
b = 25772
msg1 = 7695596237478159522452087218845013527373478230607104177524270309024459526033335750001151727866555570291892743979750985120897025450462055592528248478274362020113749559145555853098093830111817392492813273992088466078651780421143270914464677221287963762908081568342838834538516994647149568818015125152403393987410632675950398066466919926902308259336076973660543304070430193620256482213620575763644889245568141571033647659434287956659556787958083570354879801789295843963231617273422097444166050659303762035064451157393402922329616442321648473714835432708240321316535631852601475690117298226463949192488540950263855042907
msg2 = 8726827715731958059539441667281144076307125863408191935133153896621344848666078224840971961017467059048081311754984352770649072429357806259980769502126194401035117039555235808191275684416100769313649444316736944064888595183348029100504658610051446845811200104635286154291344738727317791921960633499241096213543147633334898592946532632215854688749781744916767484573725857756576525177360420560009768973850301523326349630709430357510669786471900807220296373417053854263624880781501015930954863096318711799739788646820945229128120530409860911356841163797303328058004651862646657441084726421343809574301546431146458406010

# Extended Euclidean Algorithm to find x and y
def extended_gcd(a, b):
    if b == 0:
        return a, 1, 0
    g, x1, y1 = extended_gcd(b, a % b)
    x, y = y1, x1 - (a // b) * y1
    return g, x, y

g, x, y = extended_gcd(a, b)

# Ensure x is positive
if x < 0:
    msg1 = inverse(msg1, pq)
    x = -x

if y < 0:
    msg2 = inverse(msg2, pq)
    y = -y

# Compute the flag
flag = pow(msg1, x, pq) * pow(msg2, y, pq) % pq

# Convert back to bytes
flag_bytes = long_to_bytes(flag)
print(f"{flag_bytes.decode()}")
